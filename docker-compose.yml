version: "3.2"

services:
  certbot:
    image: "certbot/certbot"
    depends_on:
      - nginx
    command: ["--version"]
    volumes:
      - "letsencrypt:/etc/letsencrypt"

  nginx:
    build: "./nginx-proxy"
    ports:
      - "443:443"
      - "80:80"
    volumes:
      - type: volume
        source: letsencrypt
        target: "/etc/letsencrypt"
        read_only: true

  znc:
    image: "znc:1.7-slim"
    volumes:
      - "zncdata:/znc-data"

  infobob:
    build: "./infobob"
    volumes:
      - "infobob:/app"
    env_file: ./env-secrets

volumes:
  infobob:
  letsencrypt:
  zncdata:
